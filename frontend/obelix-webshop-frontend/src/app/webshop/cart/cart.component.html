@if (!isOpen$$()) {
  <button type="button" class="cart-open-button" (click)="open()">
    Open Cart
  </button>
}

<div class="cart-wrapper" [class.cart-wrapper--open]="isOpen$$()">
  <div class="cart-backdrop" (click)="close()" aria-hidden="true"></div>
  <aside
    class="cart-panel"
    role="dialog"
    aria-modal="true"
    aria-labelledby="cart-title"
  >
    <header class="cart-header">
      <h2 id="cart-title">Your Cart</h2>
      <button
        type="button"
        class="cart-close"
        aria-label="Close cart"
        (click)="close()"
      >
        ×
      </button>
    </header>

    <div class="cart-items">
      @for (item of items(); track item.id) {
        <article class="cart-item">
          <img
            class="cart-item__image"
            [src]="item.imageUrl"
            [alt]="item.name"
            loading="lazy"
            width="72"
            height="72"
          />

          <div class="cart-item__content">
            <div>
              <h3 class="cart-item__title">{{ item.name }}</h3>
              <p class="cart-item__price">{{ formatPrice(item.price) }}</p>
            </div>

            <div class="cart-item__controls">
              <div class="quantity-stepper" aria-label="Quantity selector">
                <button
                  type="button"
                  (click)="decreaseQuantity(item.id)"
                  [disabled]="item.quantity === 1"
                  aria-label="Decrease quantity"
                >
                  –
                </button>
                <span>{{ item.quantity }}</span>
                <button
                  type="button"
                  (click)="increaseQuantity(item.id)"
                  aria-label="Increase quantity"
                >
                  +
                </button>
              </div>

              <button
                type="button"
                class="remove-button"
                (click)="removeItem(item.id)"
                aria-label="Remove item"
              >
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <path
                    d="M15 4V3.5C15 2.67157 14.3284 2 13.5 2H10.5C9.67157 2 9 2.67157 9 3.5V4H4.75C4.33579 4 4 4.33579 4 4.75C4 5.16421 4.33579 5.5 4.75 5.5H5.5V19.25C5.5 20.7688 6.73122 22 8.25 22H15.75C17.2688 22 18.5 20.7688 18.5 19.25V5.5H19.25C19.6642 5.5 20 5.16421 20 4.75C20 4.33579 19.6642 4 19.25 4H15ZM10.5 3.5H13.5V4H10.5V3.5ZM17 5.5V19.25C17 19.9404 16.4404 20.5 15.75 20.5H8.25C7.55964 20.5 7 19.9404 7 19.25V5.5H17ZM10 8.25C10 7.83579 9.66421 7.5 9.25 7.5C8.83579 7.5 8.5 7.83579 8.5 8.25V18.25C8.5 18.6642 8.83579 19 9.25 19C9.66421 19 10 18.6642 10 18.25V8.25ZM12.75 8.25C12.75 7.83579 12.4142 7.5 12 7.5C11.5858 7.5 11.25 7.83579 11.25 8.25V18.25C11.25 18.6642 11.5858 19 12 19C12.4142 19 12.75 18.6642 12.75 18.25V8.25ZM15.5 8.25C15.5 7.83579 15.1642 7.5 14.75 7.5C14.3358 7.5 14 7.83579 14 8.25V18.25C14 18.6642 14.3358 19 14.75 19C15.1642 19 15.5 18.6642 15.5 18.25V8.25Z"
                    fill="currentColor"
                  />
                </svg>
              </button>
            </div>
          </div>
        </article>
      } @empty {
        <p class="cart-empty">Your cart is empty.</p>
      }
    </div>

    <footer class="cart-footer">
      <div class="cart-total">
        <span>Total:</span>
        <span class="cart-total__amount">{{ formatPrice(total()) }}</span>
      </div>

      <button type="button" class="checkout-button">
        Proceed to Checkout
      </button>
    </footer>
  </aside>


</div>
